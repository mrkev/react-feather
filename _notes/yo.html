<!DOCTYPE html>
<head>
  <!-- 6f011cda-9e1c-11e6-b4f7-531e647e5630 -->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="description" content="{MetaDescription}" />
  <title>{Title} {block:PostTitle} {PostTitle} {/block:PostTitle}</title>

  <link rel="shortcut icon" href="{Favicon}">
  <link rel="alternate" type="application/rss+xml" href="{RSS}">
  <link rel="apple-touch-icon" href="{PortraitURL-128}"></link> 
  <link rel="stylesheet" href="https://gitcdn.xyz/repo/mrkev/react-feather/master/feather.css" />

  <meta name="viewport"  content="width=660"/>
</head>

<body id="blog">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react-dom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
  
  <script type="text/babel" src="https://gitcdn.xyz/repo/mrkev/react-feather/master/config.js"></script>

  <script src="build/main.bundle.js"></script>

  <script type="text/babel">

    window.getRenderedObj = function (strsrc) {
      console.log(strsrc);
      var res;
      try { eval("res = " + strsrc); return res; } 
      catch (e) { console.log(e); return null; }
    }

    // let css = `
    //   ${window.config["CustomCSS"]}
    //   body { font-family : monospace; background: ${window.config["color:Background"]}; color: ${window.config["color:Text"]}; }
    //   #footer .attribution a, #footer .attribution a:link, #footer .attribution a:visited, #header #description a, #header #description a:link, #header #description a:visited, a { color: ${window.config["color:Links"]}; }
    //   a:hover { color: ${window.config["color:Links Hover"]}; }
    //   #header h1 a { color: ${window.config["color:Heading"]}; }
    //   #header h1 a:hover { color: ${window.config["color:Heading Hover"]}; }
    //   #description { color: ${window.config["color:Description"]}; }
    //   .permalink a { color: ${window.config["color:Permalink"]}; }
    //   .permalink a:hover { color: ${window.config["color:Permalink Hover"]}; }
    //   #footer, .quote p, .photo p, .video p, .audio p, #content .conversation, .text blockquote { color: ${window.config["color:Text Alt"]}; }
    // `

    // let head  = document.head || document.getElementsByTagName('head')[0],
    //     style = document.createElement('style');

    // style.type = 'text/css';

    // if (style.styleSheet) { style.styleSheet.cssText = css; }
    // else { style.appendChild(document.createTextNode(css)); }

    // head.appendChild(style);

  </script>

  <script type="text/babel">

    var urlParams; // http://stackoverflow.com/posts/2880929/revisions
    (window.onpopstate = function () {
        var match,
            pl     = /\+/g,  // Regex for replacing addition symbol with a space
            search = /([^&=]+)=?([^&]*)/g,
            decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
            query  = window.location.search.substring(1);

        urlParams = {};
        while (match = search.exec(query))
           urlParams[decode(match[1])] = decode(match[2]);
    })();

    // From https://mathiasbynens.be/notes/xhr-responsetype-json
    var getJSON = function(url) {
      return new Promise(function(resolve, reject) {
        var xhr = new XMLHttpRequest();
        xhr.open('get', url, true);
        xhr.responseType = 'json';
        xhr.onload = function() {
          var status = xhr.status;
          if (status == 200) {
            resolve(xhr.response);
          } else {
            reject(status);
          }
        };
        xhr.send();
      });
    };

    // From https://mathiasbynens.be/notes/xhr-responsetype-json
    var getFrom = function(url) {
      return new Promise(function(resolve, reject) {
        var xhr = new XMLHttpRequest();
        xhr.open('get', url, true);
        xhr.onload = function() {
          var status = xhr.status;
          if (status == 200) {
            resolve(xhr.response);
          } else {
            reject(status);
          }
        };
        xhr.send();
      });
    };

    let raw_source =  `{
        "Title" : "Test Blgo",
      
        "Description" : 'Description! \x3cb\x3e cool \x3c/b\x3e',
      
      
        "AskEnabled" : true,
      
      
        "SubmissionsEnabled" : true,
        "SubmitLabel" : "Submit",
      

      // Pages
      
        "Pages" : {
          
            '/standard_layout' : {
              URL         : '/standard_layout',
              Label       : 'Standard',
            },
          
            '/custom_layout' : {
              URL         : '/custom_layout',
              Label       : 'custom',
            },
          
        },
      

      

      
        "IndexPage" : true,
      

      
      Pagination : {
        
          "NextPage" : "/page/2",
        
          "lang:Older" : "Older",
        
          "lang:Newer" : "Newer",
          "CurrentPage" : "1",
          "TotalPages"  : "2",
      },
      


      


      // Posts
      Posts: {
        

          '149256345671' : {

            PostType:      'quote',

            
                  "Quote"      : 'Quote no source',
                
            

            

            
            
            
            
            

              "Permalink"  : "http://localhost:3000/post/149256345671/quote-no-source",
              "lang:Notes" : "Notes",
              "NoteCount"  : "1",
              "PostNotes"  : false,
            
              "TimeAgo"    : "2 months ago",
            
            
          },
        

          '149119716676' : {

            PostType:      'photo',

            

            
                  "LinkOpenTag"      : '\x3ca href=\x22http://localhost:3000/image/149119716676\x22\x3e',
                  "LinkCloseTag"     : '\x3c/a\x3e',
                  "PhotoAlt"         : 'hey',
                  "PhotoURL-500"     : "http://68.media.tumblr.com/21685d99505c31eb0cb727c88f88628a/tumblr_oc3jl3ChLB1um2iylo1_500.png",
                
                  "Caption"          : '\x3cp\x3ehey\x3c/p\x3e',
                
            

            
            
            
            
            

              "Permalink"  : "http://localhost:3000/post/149119716676/hey",
              "lang:Notes" : "Notes",
              "NoteCount"  : "0",
              "PostNotes"  : false,
            
              "TimeAgo"    : "2 months ago",
            
            
          },
        

          '149119275321' : {

            PostType:      'chat',

            

            

            
            
            
                
                  "Title"          : "Test Chat",
                
                  Lines : {
                    
                      '1' : {
                        Label      : '',
                        Name       : 'digi123',
                        Line       : 'this is cool',
                        UserNumber : '1',
                      },
                    
                      '2' : {
                        Label      : '',
                        Name       : 'digi123',
                        Line       : 'I think it is',
                        UserNumber : '2',
                      },
                    
                      '3' : {
                        Label      : '',
                        Name       : 'digi123',
                        Line       : 'cool',
                        UserNumber : '3',
                      },
                    
                  },
            
            
            

              "Permalink"  : "http://localhost:3000/post/149119275321/test-chat",
              "lang:Notes" : "Notes",
              "NoteCount"  : "0",
              "PostNotes"  : false,
            
              "TimeAgo"    : "2 months ago",
            
            
          },
        

          '149118577261' : {

            PostType:      'audio',

            

            

            
            
            
            
            
                  "AudioPlayerGrey"      : '\x3cspan id=\x22audio_player_149118577261\x22\x3e\x3cdiv class=\x22audio_player\x22\x3e\x3ciframe class=\x22tumblr_audio_player tumblr_audio_player_149118577261\x22 src=\x22http://localhost:3000/post/149118577261/audio_player_iframe/digi123/tumblr_o6hobkFzUE1t86pqs?audio_file=https%3A%2F%2Fwww.tumblr.com%2Faudio_file%2Fdigi123%2F149118577261%2Ftumblr_o6hobkFzUE1t86pqs\x26color=grey\x26simple=1\x22 frameborder=\x220\x22 allowtransparency=\x22true\x22 scrolling=\x22no\x22 width=\x22207\x22 height=\x2227\x22\x3e\x3c/iframe\x3e\x3c/div\x3e\x3c/span\x3e',
                  "PlayCountWithLabel"   : "9 plays",
                
                  "Caption"              : '\x3cp\x3e\x3ca class=\x22tumblr_blog\x22 href=\x22http://shoesnosocks.tumblr.com/post/143673811745\x22\x3eshoesnosocks\x3c/a\x3e:\x3c/p\x3e\x3cblockquote\x3e\x3cp\x3eJust late night musings\x3c/p\x3e\x3c/blockquote\x3e\x3cp\x3e(via \x3ca href=\\http://shotonoca.ml/post/143673811745/just-late-night-musings\\\x3eshoesnosocks\x3c/a\x3e)\x3c/p\x3e',
                
                
                
                
                  "TrackName" : "V MALLOY (WIP PT2 / ASIA OTWT RM DRAFT / TB)",
                
            

              "Permalink"  : "http://localhost:3000/post/149118577261/shoesnosocks-just-late-night-musings",
              "lang:Notes" : "Notes",
              "NoteCount"  : "1",
              "PostNotes"  : false,
            
              "TimeAgo"    : "2 months ago",
            
            
          },
        

          '148340059506' : {

            PostType:      'video',

            

            

            
                  "Video-500"  : '\x3ciframe width=\x22500\x22 height=\x22281\x22  id=\x22youtube_iframe\x22 src=\x22https://www.youtube.com/embed/3797PZSKzaw?feature=oembed\x26amp;enablejsapi=1\x26amp;origin=http://safe.txmblr.com\x26amp;wmode=opaque\x22 frameborder=\x220\x22 allowfullscreen\x3e\x3c/iframe\x3e',
                  "Caption"    : '\x3cp\x3elol\x3c/p\x3e',
                  "lang:Notes" : "Notes",
            
            
            
            
            

              "Permalink"  : "http://localhost:3000/post/148340059506/lol",
              "lang:Notes" : "Notes",
              "NoteCount"  : "0",
              "PostNotes"  : false,
            
              "TimeAgo"    : "2 months ago",

        },
      }
    }` 

    Promise.resolve(window.getRenderedObj(raw_source))
    .then(props => {
      if (!props) throw new Error("LAME");
      window.props = props;
      console.log(props)
      if (urlParams['render'] !== 'raw') {
        ReactDOM.render(
          <Blog {... props} />,
          document.getElementById('blog')
        );
      } else {
        document.open();
        document.write(JSON.stringify(props));
        document.close();
      }
    })
    .catch(console.error);

  </script>
  </body>
</html>