<!DOCTYPE html>
<head>
  <!-- 6f011cda-9e1c-11e6-b4f7-531e647e5630 -->
  <!-- 
    The line above identifies this as a tumblr+react theme.
    Do not remove!
  -->
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="description" content="{MetaDescription}" />
  <title>{Title} {block:PostTitle} {PostTitle} {/block:PostTitle}</title>

  <link rel="shortcut icon" href="{Favicon}">
  <link rel="alternate" type="application/rss+xml" href="{RSS}">
  <link rel="apple-touch-icon" href="{PortraitURL-128}"></link> 
  <link rel="stylesheet" href="https://gitcdn.xyz/repo/mrkev/react-feather/master/feather.css" />

  <meta name="viewport"  content="width=660"/>
</head>

<body id="blog">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react-dom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
  
  <script type="text/babel" src="https://gitcdn.xyz/repo/mrkev/react-feather/bundler/config.js"></script>
  <script type="text/babel" src="https://gitcdn.xyz/repo/mrkev/react-feather/bundler/build/main.bundle.js"></script>
  
  <!-- HELPERS -->

  <script> /** Parses URL params */
  var urlParams; // http://stackoverflow.com/posts/2880929/revisions
  (window.onpopstate = function () {
      var match,
          pl     = /\+/g,  // Regex for replacing addition symbol with a space
          search = /([^&=]+)=?([^&]*)/g,
          decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
          query  = window.location.search.substring(1);

      urlParams = {};
      while (match = search.exec(query))
         urlParams[decode(match[1])] = decode(match[2]);
  })();
  </script>

  <script type="text/babel">
  /** Dynamically loads a script */
  window.loadScript = (url, callback) => new Promise((res, rej) => {
      let script     = document.createElement('script')
      script.type    = "text\/babel"
      script.onerror = rej
      script.onload  = res
      document.head.appendChild(script)
      script.src     = url
      console.log(script)
  })

  window.loadScript('./lol.js')
  .then(x => console.log('YAY'))
  .catch(console.error)
  console.log('asdf')
  </script>

  <script type="text/babel">

    window.getRenderedObj = function (strsrc) {
      var res;
      try { eval("res = " + strsrc); return res; } 
      catch (e) { console.error(e); return null; }
    }

    let css = `
      ${window.config["CustomCSS"]}
      body { font-family : monospace; background: ${window.config["color:Background"]}; color: ${window.config["color:Text"]}; }
      #footer .attribution a, #footer .attribution a:link, #footer .attribution a:visited, #header #description a, #header #description a:link, #header #description a:visited, a { color: ${window.config["color:Links"]}; }
      a:hover { color: ${window.config["color:Links Hover"]}; }
      #header h1 a { color: ${window.config["color:Heading"]}; }
      #header h1 a:hover { color: ${window.config["color:Heading Hover"]}; }
      #description { color: ${window.config["color:Description"]}; }
      .permalink a { color: ${window.config["color:Permalink"]}; }
      .permalink a:hover { color: ${window.config["color:Permalink Hover"]}; }
      #footer, .quote p, .photo p, .video p, .audio p, #content .conversation, .text blockquote { color: ${window.config["color:Text Alt"]}; }
    `

    let head  = document.head || document.getElementsByTagName('head')[0],
        style = document.createElement('style');

    style.type = 'text/css';

    if (style.styleSheet) { style.styleSheet.cssText = css; }
    else { style.appendChild(document.createTextNode(css)); }

    head.appendChild(style);

  </script>




  <script type="text/babel">

    let raw_source = /*586f3690*/ `{
        "Title" : "{Title}",
      {block:Description}
        "Description" : {JSDescription},
      {/block:Description}
      {block:AskEnabled}
        "AskEnabled" : true,
      {/block:AskEnabled}
      {block:SubmissionsEnabled}
        "SubmissionsEnabled" : true,
        "SubmitLabel" : "{SubmitLabel}",
      {/block:SubmissionsEnabled}

      // Pages
      {block:HasPages}
        "Pages" : {
          {block:Pages}
            {JSURL} : {
              URL         : {JSURL},
              Label       : {JSLabel},
            },
          {/block:Pages}
        },
      {/block:HasPages}

      {block:PermalinkPage}
        "PermalinkPage" : true,
      {/block:PermalinkPage}

      {block:IndexPage}
        "IndexPage" : true,
      {/block:IndexPage}

      {block:Pagination}
      Pagination : {
        {block:NextPage}
          "NextPage" : "{NextPage}",
        {/block:NextPage}
          "lang:Older" : "{lang:Older}",
        {block:PreviousPage}
          "PreviousPage" : "{PreviousPage}",
        {/block:PreviousPage}
          "lang:Newer" : "{lang:Newer}",
          "CurrentPage" : "{CurrentPage}",
          "TotalPages"  : "{TotalPages}",
      },
      {/block:Pagination}


      {block:PermalinkPagination}
      PermalinkPagination : {
        {block:PreviousPost}
          "PreviousPost" : "{PreviousPost}",
        {/block:PreviousPost}
          "lang:Older" : "{lang:Older}",
        {block:NextPost}
          "NextPost" : "{NextPost}",
        {/block:NextPost}
          "lang:Newer" : "{lang:Newer}",
          "CurrentPage" : "{CurrentPage}",
          "TotalPages"  : "{TotalPages}",
      },
      {/block:PermalinkPagination}


      // Posts
      Posts: {
        {block:Posts inlineMediaWidth="500"}

          {JSPostID} : {

            PostType:      {JSPostType},

            {block:Quote}
                  "Quote"      : {JSQuote},
                {block:Source}
                  "Source"     : {JSSource},
                {/block:Source}
            {/block:Quote}

            {block:Photo}
                  "LinkOpenTag"      : {JSLinkOpenTag},
                  "LinkCloseTag"     : {JSLinkCloseTag},
                  "PhotoAlt"         : {JSPhotoAlt},
                  "PhotoURL-500"     : "{PhotoURL-500}",
                {block:Caption}
                  "Caption"          : {JSCaption},
                {/block:Caption}
            {/block:Photo}

            {block:Video}
                  "Video-500"  : {JSVideo-500},
                  "Caption"    : {JSCaption},
                  "lang:Notes" : "{lang:Notes}",
            {/block:Video}
            {block:Link}
                  "Target": '{Target}',
                  "URL" : "{URL}",
                  "Name" : "{Name}",
                {block:Description}
                  "Description" : "{Description}",
                {/block:Description}
            {/block:Link}
            {block:Chat}
                {block:Title}
                  "Title"          : "{Title}",
                {/block:Title}
                  Lines : {
                    {block:Lines}
                      {JSUserNumber} : {
                        Label      : {JSLabel},
                        Name       : {JSName},
                        Line       : {JSLine},
                        UserNumber : {JSUserNumber},
                      },
                    {/block:Lines}
                  },
            {/block:Chat}
            {block:Text}
                  "Title"      : "{Title}",
                  "Body"       : {JSBody},
            {/block:Text}
            {block:Audio}
                  "AudioPlayerGrey"      : {JSAudioPlayerGrey},
                  "PlayCountWithLabel"   : "{PlayCountWithLabel}",
                {block:Caption}
                  "Caption"              : {JSCaption},
                {/block:Caption}
                {block:ExternalAudio}
                  "ExternalAudioURL"     : "{ExternalAudioURL}",
                "lang:Download"          : "{lang:Download}"
                {/block:ExternalAudio}
                {block:Artist}
                  "Artist"               : "{Artist}",
                {/block:Artist}
                {block:TrackName}
                  "TrackName" : "{TrackName}",
                {/block:TrackName}
            {/block:Audio}

              "Permalink"  : "{Permalink}",
              "lang:Notes" : "{lang:Notes}",
              "NoteCount"  : "{NoteCount}",
              "PostNotes"  : false,
            {block:Date}
              "TimeAgo"    : "{TimeAgo}",
            {/block:Date}
            {block:PostNotes}
              "PostNotes"  : {JSPostNotes},
            {/block:PostNotes}
          },
        {/block:Posts}
      }
    }` /*586f3690*/

    // Promise.resolve(window.getRenderedObj(raw_source))
    // .then(props => {
    //   if (!props) throw new Error("LAME");
    //   window.props = props;


    //   if (urlParams['render'] !== 'raw') {
    //     ReactDOM.render(
    //       <Blog {... props} />,
    //       document.getElementById('blog')
    //     );
    //   } else {
    //     document.open();
    //     document.write(JSON.stringify(props));
    //     document.close();
    //   }
    // })


    // .catch(console.error);

  </script>
  </body>
</html>
